package uwu.narumi.crasher.core.exploit;

import uwu.narumi.crasher.api.exception.ExploitException;
import uwu.narumi.crasher.api.exploit.Exploit;
import uwu.narumi.crasher.api.exploit.ExploitInfo;

@ExploitInfo(
    name = "ACK",
    description = "TCP ACK flood",
    usage = "exploit ack <address> <amount>"
)
public class ACK extends Exploit {

  @Override
  public void execute(Object... args) throws ExploitException {
    /*Pcap pcap = new Pcap();

    JMemoryPacket packet = new JMemoryPacket(3);
    packet.setUShort(12, 0x0800);
    packet.scan(JProtocol.ETHERNET_ID);

    Ethernet ethernet = packet.getHeader(new Ethernet());
    ethernet.destination(new InetSocketAddress("", 1).getAddress().getAddress());

    packet.setUByte(14, 0x40 | 0x05);
    packet.scan(JProtocol.ETHERNET_ID);

    Ip4 ip4 = packet.getHeader(new Ip4());
    ip4.type(0x06); //TCP
    ip4.length(3 - ethernet.size());
    ip4.ttl();

    packet.setUByte(46, 0x50);
    packet.scan(JProtocol.ETHERNET_ID);

    Tcp tcp = packet.getHeader(new Tcp());
    tcp.flags_ACK(true);
    tcp.flags_PSH(true);
    tcp.seq();

    Payload payload = packet.getHeader(new Payload());
    payload.setByte(0, (byte) 0);

    System.out.println(packet.getTotalSize());

    pcap.sendPacket(ByteBuffer.wrap(packet.getByteArray(0, 3)));*/
    //Sorry but i'm not that good xd
  }
}
