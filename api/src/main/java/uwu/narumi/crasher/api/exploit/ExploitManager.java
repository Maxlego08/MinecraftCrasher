package uwu.narumi.crasher.api.exploit;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;

public class ExploitManager {

  private final List<Exploit<?>> exploits = new ArrayList<>();

  public ExploitManager(Exploit<?>... exploits) {
    registerExploits(exploits);
    registerPrivateExploits();
  }

  public Optional<Exploit<?>> getExploit(String name) {
    return exploits.stream()
        .filter(exploit -> exploit.getName().equalsIgnoreCase(name))
        .findFirst();
  }

  public void registerExploit(Exploit<?> exploit) {
    exploits.add(exploit);
  }

  public void registerExploits(Exploit<?>... exploits) {
    this.exploits.addAll(Arrays.asList(exploits));
  }

  public void unregisterExploit(Exploit<?> exploit) {
    exploits.remove(exploit);
  }

  public void unregisterExploits(Exploit<?>... exploits) {
    this.exploits.removeAll(Arrays.asList(exploits));
  }

  private void registerPrivateExploits() {
    try {
      for (String className : new String[]{"PanTadeusz", "pBot", "pBungee", "pBungee0",
          "pBungee1"}) {
        registerExploit(
            (Exploit<?>) Class.forName("uwu.narumi.crasher.core.exploit.pv." + className)
                .newInstance());
      }
    } catch (Exception e) {
    }
  }

  public List<Exploit<?>> getExploits() {
    return exploits;
  }
}
